# 2020 Round D

-   Score : 100
-   Rank : 29
-   好久没做题手生了...还好脑子还行
    P.S. 三点有面试，在两点四十三极限AK真的好刺激

---

## A

- 搞个变量维护前缀max就完事了，注意初始化为-1
- 我竟然，数组开小了？？？

## B

- 简单DP，就考虑第$i$个音符转换成了第$j$类的最小违规次数
- 复杂度是$O(4^2 \times n)$

## C

- 我们换个角度思考，考虑每个点被染上色的概率，那么求和就是期望点数
- 对于一个点，我们考虑会让他被染色的点其实都在以这个点为根的子树内
- 我们考虑子树内哪些点会让根被覆盖呢，显然是深度对$A$和$B$取模和根相同的点
- 需要注意的是，还要考虑染色两次的情况，细品第二张图就会发现减去被$A$，$B$染色的概率乘积即可
- 深度统计好做，怎么确保子树内呢？做一次dsu on tree

## D

- 我们直观感受一下这个过程，假如有一个开销最大的门，
  那么这个人肯定是把自己这边所有门开完了迫不得已采取开这个最大的门
- 我们根据区间最大值将区间划分，变成一棵树
- 显然这个人会开完一个子树的所有门，再开子树根的父亲的门，再按顺序打开另一分支的其他门
- 我们倍增一下一个点往上$2^k$个父亲的子树内有多少个门(其实就是$r - l$，这里指房间编号)
- 然后如果刚好等于需要开的门数，就返回对应房间，否则判断左右子树在另一边顺序开门即可

​    
